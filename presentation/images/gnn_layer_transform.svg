<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="520" viewBox="0 0 1400 520" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Graph layer transform diagram">
  <style>
    .panel { fill: rgba(2,6,23,0.04); stroke: rgba(30,41,59,0.06); }
    .node { fill: #fbbf24; stroke: #0b1220; stroke-width:2px; }
    .node-light { fill: #fff1d6; stroke: #0b1220; stroke-width:1.5px; }
    .edge { stroke: #7dd3fc; stroke-width:6px; stroke-linecap:round; opacity:0.95 }
    .edge-dark { stroke: #0369a1; stroke-width:8px; stroke-linecap:round; opacity:0.9 }
    .label { font-family: Arial, sans-serif; fill: #cbd5e1; font-size:16px; }
    .title { font-family: Arial, sans-serif; fill: #cbd5e1; font-size:18px; font-weight:600; }
    .fn { font-family: 'Courier New', monospace; fill: #94a3b8; font-size:18px; }
    .box { fill:#0f172a; stroke:#0b1220; rx:8; }
    .nn { fill:none; stroke:#cbd5e1; stroke-width:2; }
  </style>

  <!-- Left: Layer N (graph in) -->
  <g transform="translate(80,60)">
    <rect x="0" y="0" width="360" height="360" rx="12" class="panel" />
    <text x="180" y="26" text-anchor="middle" class="title">Layer N<br/><tspan class="label">graph in</tspan></text>
    <!-- nodes -->
    <circle cx="80" cy="120" r="18" class="node-light" />
    <circle cx="160" cy="70" r="20" class="node" />
    <circle cx="240" cy="140" r="16" class="node-light" />
    <circle cx="120" cy="200" r="14" class="node-light" />
    <circle cx="220" cy="220" r="12" class="node-light" />
    <!-- edges -->
    <line x1="80" y1="120" x2="160" y2="70" class="edge" />
    <line x1="160" y1="70" x2="240" y2="140" class="edge-dark" />
    <line x1="80" y1="120" x2="120" y2="200" class="edge" />
    <line x1="120" y1="200" x2="220" y2="220" class="edge" />
  </g>

  <!-- Right: Layer N+1 (graph out) -->
  <g transform="translate(1000,60)">
    <rect x="-20" y="0" width="360" height="360" rx="12" class="panel" />
    <text x="160" y="26" text-anchor="middle" class="title">Layer N+1<br/><tspan class="label">graph out</tspan></text>
    <circle cx="80" cy="120" r="18" class="node-light" />
    <circle cx="160" cy="70" r="20" class="node" />
    <circle cx="240" cy="140" r="16" class="node-light" />
    <circle cx="120" cy="200" r="14" class="node-light" />
    <circle cx="220" cy="220" r="12" class="node-light" />
    <!-- emphasized edges (thicker) representing updated features -->
    <line x1="80" y1="120" x2="160" y2="70" class="edge-dark" />
    <line x1="160" y1="70" x2="240" y2="140" class="edge-dark" />
    <line x1="80" y1="120" x2="120" y2="200" class="edge" />
    <line x1="120" y1="200" x2="220" y2="220" class="edge-dark" />
  </g>

  <!-- Middle: Graph independent layer box and arrows -->
  <g transform="translate(450,80)">
    <rect x="0" y="0" width="480" height="300" rx="12" fill="rgba(15,23,42,0.06)" stroke="rgba(30,41,59,0.08)" />
    <text x="240" y="26" text-anchor="middle" class="title">Graph Independent Layer</text>

    <!-- rows for U, V, E -->
    <g transform="translate(40,60)">
      <text x="0" y="6" class="label">U_n</text>
      <line x1="40" y1="2" x2="420" y2="2" stroke="#334155" stroke-dasharray="6 6" />
      <text x="440" y="6" class="fn">U_{n+1}</text>

      <text x="0" y="56" class="label">V_n</text>
      <line x1="40" y1="52" x2="420" y2="52" stroke="#334155" stroke-dasharray="6 6" />
      <text x="440" y="56" class="fn">V_{n+1}</text>

      <text x="0" y="106" class="label">E_n</text>
      <line x1="40" y1="102" x2="420" y2="102" stroke="#334155" stroke-dasharray="6 6" />
      <text x="440" y="106" class="fn">E_{n+1}</text>
    </g>

    <!-- small NN icon / update function box -->
    <g transform="translate(160,190)">
      <rect x="0" y="0" width="160" height="80" rx="8" class="box" />
      <text x="80" y="28" text-anchor="middle" class="label">update function</text>
      <!-- small NN nodes -->
      <g transform="translate(28,40)">
        <circle cx="0" cy="0" r="4" fill="#cbd5e1" />
        <circle cx="24" cy="0" r="4" fill="#cbd5e1" />
        <circle cx="48" cy="0" r="4" fill="#cbd5e1" />
        <line x1="0" y1="0" x2="24" y2="0" class="nn" />
        <line x1="24" y1="0" x2="48" y2="0" class="nn" />
      </g>
    </g>

  </g>

  <!-- single curved arrow above the Graph Independent Layer -->
  <path d="M360 140 C 540 60, 840 60, 1060 140" stroke="#94a3b8" stroke-width="4" fill="none" marker-end="url(#arr1)" stroke-linecap="round" stroke-linejoin="round" />

  <defs>
    <marker id="arr1" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0 0 L8 3 L0 6 z" fill="#94a3b8" />
    </marker>
  </defs>

  <!-- footer label -->
  <text x="700" y="510" text-anchor="middle" class="label">Per-layer transformation: update features for nodes, edges and globals</text>
</svg>
